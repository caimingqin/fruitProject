<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>好丽友客户服务平台</title>
<link rel="stylesheet" type="text/css" href="../rs/css/themes/orion/main.css"/>
<script type="text/javascript" src="../rs/js/lib/jquery-1.6.min.js"></script>
<script type="text/javascript" src="../rs/js/lib/jquery-1.4.4.min.js"></script>
<script type="text/javascript" src="../rs/js/lib/jquery.easyui.min.js"></script>
<script type="text/javascript" src="../js/common.js"></script>
<script type="text/javascript" src="../js/lib/JSon.js"></script>
<script type="text/javascript" src="../js/common/session.js"></script>
<script type="text/javascript">
$.include('../css/20110607[a].css','cssfile');//动态添加css id=newfile
$.include('../js/admincommon.js','adminjsfile');
//权限设置
function configRole(obj)
{
	if(obj==0)
	{
		$("#cssfile")[0].href="../css/20110607[a].css";//动态添加css id=newfile
	}
	else
	{
	   $("#cssfile")[0].href="../rs/css/20110607[b].css";
	}
	
}


function imageChange(imageObjName, imgName)
{
	var oIcon = document.getElementById(imageObjName);
	oIcon.src=imgName;
}


function changeSubMenu(obj)
{
	$("#divsubmenu").empty();
	//alert(JSON.stringify(obj));
	$.each(obj,function(i,item){
				if(item.viewPage==null)
				{		if(item.children.length>0)
				{
						
					 	$("#divsubmenu").append('<div style="float: left;"><a href="#"  onMouseOver="menuonMouseOver(\'menu_'+item.code+'\');" onMouseOut="menuonMouseOut(\'menu_'+item.code+'\');" >'+item.name+'</a></div>'); 
						}
						else
						{						
							$("#divsubmenu").append('<div style="float: left;"><a href="#">'+item.name+'</a></div>'); 
						}
				}
				else
				{
		 				$("#divsubmenu").append('<div style="float: left;"><a href="javascript:addTab(\''+item.code+'\',\''+item.name+'\',\''+HOST_ADDRESS+item.viewPage.contents+'\');">'+item.name+'</a></div>'); 
				}
				if(item.children.length>0)
			  {
			  	$("#divsubmenu").append(getThirdMenu(item.code,item.children));
			  }
			  if(i!=obj.length-1)
			  {
			 		  $("#divsubmenu").append('<div class="line">&nbsp;</div>'); 
			  }
	});
}

function getThirdMenu(id,datalist)
{ 
	  if($("#menu_"+id).length==0)
	  {            
			  	$("#s-menu").append('<div id="menu_'+id+'" class="s-menu" onMouseOver="menuonMouseOver(\'menu_'+id+'\');"  onMouseOut="menuonMouseOut(\'menu_'+id+'\');" ></div>');
			  	$.each(datalist,function(i,item){
							if(item.viewPage==null)
							{
									$("#menu_"+id).append('<div class="colorchage" style="padding:3px;margin-left:2px;" onclick="closemenu(\'menu_'+id+'\')">'+item.name+'</div>');
							}
							else
							{
									$("#menu_"+id).append('<div class="colorchage" style="padding:3px;margin-left:2px;" onclick="closemenu(\'menu_'+id+'\')"><A href="javascript:addTab(\''+item.code+'\',\''+item.name+'\',\''+HOST_ADDRESS+item.viewPage.contents+'\');">'+item.name+'</A></div>');
							}
				 });     
	  }
	return '<div style="float: left; margin-left:5px; margin-top:1px;" ><A HREF="#"><img src="../rs/img/icon2.png"  id="img_'+id+'" onMouseOver="menuonMouseOver(\'menu_'+id+'\');" onMouseOut="menuonMouseOut(\'menu_'+id+'\');"  /></A></div>';   
}

function closemenu(id)
{
	$("#"+id).css("visibility","hidden");
}
function menuonMouseOver(id)
{
	imageChange('img_'+id.split('_')[1],'../rs/img/icon1.png'); 
	$("#"+id).css("visibility","visible");
 	var offsettop=$("#img_"+id.split('_')[1]).offset().top;    
 	var offsetleft=$("#img_"+id.split('_')[1]).offset().left;           
 	$("#"+id).css({position: "absolute",'top':offsettop+13,'left':offsetleft-84});
}
function menuonMouseOut(id)
{
	imageChange('img_'+id.split('_')[1],'../rs/img/icon2.png');   
	$("#"+id).css("visibility","hidden");
	//alert($("#divsubmenu").html());
}
function getMenus(menu)
{		
	var url=HOST_ADDRESS+"OrionCommons/resources/app/"+AppCodeByRoles+"/menus/";
	//alert(url);
	$.ajax({
			type:"GET",
			dataType:"json",
			contentType:"application/json",
			url:url,
			success: function(data) {
				if(data.contents.length>0)
				{
						$("#divmenu").html("");
					  $.each(data.contents, function (i, item) {
							if(item.name==menu||(menu==""&&i==0))
							{
								$("#divmenu").append("<strong><span>"+item.name+"</span></strong>"); 
								menu=item.name;
								if(item.children!="undefined")
								{
							    	changeSubMenu(item.children);
							  }
							}
							else
							{
								$("#divmenu").append("<a href='#' class='tab1'><span onclick=getMenus('"+item.name+"')>"+item.name+"</span></a>");
							}
        	 });
				}
			},
			error: function(msg){
				alert(JSON.stringify(msg));
			}
		});
}
//动态增加tab
function addTab(id,name,url){
	if ($('#tt').tabs('exists', name))
	{                                                                      
			$('#tt').tabs('select', name);                                                                
	} 
	else 
	{
		var	content ='<div id="'+id+'" name="'+id+'" title="'+name+'"  closable="true" " border="false"><iframe id="i'+id+'" name="i'+id+'" src="'+url+'" height="1000"  frameborder="no" border="0" marginwidth="0"  marginheight="0" scroll="no" style="overflow:hidden;" allowtransparency="yes" width="100%"></iframe></div>';
		
		$('#tt').tabs('add',{
				title:name,
				content:content,
				closable:true
				});
		$("#tt").find("[class=panel-body panel-body-noheader panel-body-noborder]").css("overflow","hidden");
 		$("#tt").find("[class=panel-body panel-body-noheader panel-body-noborder]").attr("scroll","no");
	}     
	 
}

 $(function () {
 		xfn_getUserInfor();
 	
 });
//-->
</script> 
</head>
<body>
<!--隐藏控件-->
<input type="hidden" id="txtMtype" value="" />
<input type="hidden" id="txtUserRole" value="0" />
<div class="easyui-layout" fit=true style="height:100%; min-width:1024px; min-height:560px;" id="main_layer">
			<!-- 从此开始不可见块区域 -->
			<div id="s-menu"></div>
			<!--end子菜单下拉-->
	<div region="north"  style="overflow:hidden; height:auto; clear: both;"  border="false">
	<div id="top-head">
		<!-- 公司logo -->
		<div class="logo">
			<img src="../rs/img/top_logo.png" alt="Logo" width="249" height="37" />
		</div>
		<!-- 登录信息 -->
		<div class="login">
			<!--test-->
			<img src="../rs/img/bt_exit.png" width="16" height="37" align="absmiddle" />
		</div>
		<!-- 大菜单开始 -->
		<div class="guidemenu">
			<div id="divMeasureType">
					<a><img id="m01" src="../rs/img/bt_01.jpg"  border="0"/></a><a ><img id="m02" src="../rs/img/bt_02.jpg"  border="0"/></a><a ><img id="m03"  src="../rs/img/bt_03.jpg"  border="0"/></a><a ><img id="m04"  src="../rs/img/bt_04.jpg" border="0"/></a>
		</ul>
		</div> 
		</div>  
		<!-- 大菜单结束 -->
	</div>
	<!-- main start -->
	<div class="one-tabs">
		<table width="100%" border="0" cellspacing="0" cellpadding="0" height="49">
			<tr>
	<td width="23" rowspan="2" height="49"><a href="#" ><img src="../rs/img/tab_option.png" alt="漂浮菜单" width="24" height="49" align="bottom" /></a></td><td width="" height="26" background="../rs/img/t_bg1.png" align="top"><div class="menus">
						<!--one taps start -->
						<div id="divmenu" class="menus-tab">
						<!-- one taps end -->
					</div>

				</td>
			</tr><tr><td height="23" valign="middle" background="../rs/img/t_bg2.png">
					<!-- one taps sub menu start -->
					<div id="divsubmenu" class="menus-list">
			        </div>
					<!-- one taps sub menu end -->
				</td>
			</tr>
		</table>
		<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#ffffff">
			<tr><td height="5" background="../rs/img/t_bg3.png"><IMG SRC="../rs/img/t_bg3.png" WIDTH="1" HEIGHT="5" BORDER="0"></td></tr>
			<tr><td height="5"></td></tr>
		</table>
	</div>
	</div>
<div region="center"  style="overflow:hidden; height:auto; clear: both;"  border="false">   

	<div id="tt" class="easyui-tabs" fit=true scroll="no" style="overflowd:hidden;">
	<!-- 生成 动态TAB -->
	</div>
</div>
	<!-- main end -->
	<div region="south" style="height:auto;"  border="false" >
		<div id="foot-copylight">

			<img src="../rs/img/copylight.png" width="221" height="28" align="absmiddle" />
		</div>
	</div>
</div>
</body>
</html>


</body>
</html>